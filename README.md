# Задача L0

## Содержание

- [Что было сделано](#было-сделано)
- [Функциональные возможности](#функциональные-возможности)
- [Структура проекта](#структура-проекта)
- [Установка](#установка)
- [Конфигурация](#конфигурация)
- [Запуск приложения](#запуск-приложения)
- [API-точки доступа](#api-точки-доступа)

## Было сделано

- Сервисы PostgreSQL, NATS Streaming и http сервер были развернуты в Docker, *docker-compose.yml* доступен по этой [ссылке](dev/docker-compose.yml)
- Были созданы таблицы в бд. Миграция расположена [тут](internal/app/migrations/000001_init.up.sql)
- Была реализована [работа с NATS Streaming](internal/nats/nats.go)
- Было реализовано [кеширование in memory](internal/cache/cache.go)
- Был реализован простейший интерфейс для отображения полученных данных, который доступен по адресу http://localhost:8000/orders
- Был создан отдельный [скрипт](nats_script.go) для генерирования рандомного сообщения и отправки его в NATS Streaming. Для его использования выполните команду `go run nats_script.go`

## Функциональные возможности

- **Управление заказами:** Позволяет создавать, обновлять и получать заказы.
- **Интеграция с NATS:** Интегрируется с NATS Streaming для очередей сообщений и событийной архитектуры.
- **Взаимодействие с базой данных:** Взаимодействует с базой данных PostgreSQL для хранения данных.
- **HTTP-сервер:** Предоставляет HTTP-сервер для обработки запросов API.
- **Управление кэшем:** Использует механизм кэширования для оптимизации производительности.
- **Логирование:** Реализует структурированное логирование с использованием Zap.

## Структура проекта

Проект имеет следующую структуру:

- `cmd/L0`: Содержит основную точку входа в приложение.
- `config`: Управляет конфигурацией приложения.
- `internal`: Содержит основную логику приложения.
  - `api/http`: Обрабатывает маршрутизацию и обработку HTTP-запросов.
  - `cache`: Управляет операциями кэширования.
  - `db`: Обрабатывает взаимодействие с базой данных.
  - `nats`: Интегрирует с NATS Streaming.
  - `repository`: Предоставляет уровень доступа к данным.
  - `usecase`: Реализует сценарии использования и бизнес-логику.

## Установка

Чтобы установить бэкэнд-приложение, выполните следующие шаги:

1. Склонируйте репозиторий
```bash
git clone <repository-url>
```
2. Перейдите в директорию проекта
```bash
cd <project-directory>
```

## Конфигурация

Приложение можно настроить с помощью переменных среды или файла [`.env`](dev/.env). Доступны следующие параметры конфигурации:

Переменные конфигурации для данного приложения:

- `LOG_LEVEL`: Уровень логирования (panic, fatal, warn, debug, info).
- `DEBUG`: Режим разработки.
- `PATH_LOG`: Путь к файлу лога.
- `APP_NAME`: Название приложения.
- `APP_VERSION`: Версия приложения.
- `HTTP_HOST`: Хост HTTP-сервера.
- `HTTP_PORT`: Порт HTTP-сервера.
- `NATS_HOST`: Хост NATS.
- `NATS_PORT`: Порт NATS.
- `NATS_CLUSTER_ID`: Идентификатор кластера NATS.
- `NATS_CLIENT_ID`: Идентификатор клиента NATS.
- `NATS_SUBJECT`: Тема NATS.
- `DB_HOST`: Хост базы данных.
- `DB_PORT`: Порт базы данных.
- `DB_NAME`: Имя базы данных.
- `DB_USER`: Имя пользователя базы данных.
- `DB_PASS`: Пароль пользователя базы данных.
- `DB_SSLMODE`: Режим SSL базы данных.

## Запуск приложения

Для запуска приложения используйте следующую команду:

```bash
docker compose -f ./dev/docker-compose.yml up -d --build
```

## API-точки доступа

Бэкэнд-приложение предоставляет следующие API-точки доступа:

- `/orders`: Предоставляет HTML страницу с информацией о заказах.
- `/orders/id/:id`: Предоставляет информацию о конкретном заказе по id. 